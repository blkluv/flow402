(()=>{var e={};e.id=298,e.ids=[298],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},1041:e=>{"use strict";e.exports=require("node:url")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5060:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>f,originalPathname:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c}),r(1958),r(2846),r(5866);var n=r(3191),i=r(8716),s=r(7922),o=r.n(s),l=r(5231),a={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>l[e]);r.d(t,a);let c=["",{children:["demo",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1958)),"/Users/thewizardofhahz/flow402/app/demo/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2846)),"/Users/thewizardofhahz/flow402/app/layout.jsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/thewizardofhahz/flow402/app/demo/page.jsx"],d="/demo/page",f={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/demo/page",pathname:"/demo",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7984:(e,t,r)=>{Promise.resolve().then(r.bind(r,6535))},1597:(e,t,r)=>{Promise.resolve().then(r.bind(r,9643))},1448:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},6535:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var n,i=r(326),s=r(7577);function o({isPlaying:e,type:t="random",video:r=null}){let n=(0,s.useRef)(null),o=(0,s.useRef)(null);(0,s.useRef)(null);let[l,a]=(0,s.useState)(!1),c={youtube:{kind:"youtube",id:"1jzROE6EhxM"},movie:{kind:"video",url:"https://github.com/JamieMay2020/flow402/blob/main/1027.mp4?raw=true",poster:"/movie-poster.jpg"},random:{kind:"video",url:"https://www.w3schools.com/html/mov_bbb.mp4"}},u=c[t]||c.random;if(r){let e=function(e){try{let t=new URL(e);if("youtu.be"===t.hostname)return t.pathname.slice(1).split("?")[0];if(t.hostname.includes("youtube.com")){if(t.pathname.startsWith("/embed/"))return t.pathname.split("/embed/")[1].split("/")[0];if(t.searchParams.get("v"))return t.searchParams.get("v")}}catch{}return null}(r.videoUrl),t=function(e){try{let t=new URL(e);if(t.hostname.includes("twitch.tv")){if("player.twitch.tv"===t.hostname)return t.searchParams.get("channel")||null;let e=t.pathname.split("/").filter(Boolean);if(e.length>0)return e[0]}}catch{}return null}(r.videoUrl);u=e?{kind:"youtube",id:e}:t?{kind:"twitch",channel:t}:{kind:"video",url:r.videoUrl,poster:r.thumbnailUrl}}return(0,i.jsxs)("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden",children:[r?.ownerPublicKey&&i.jsx("button",{type:"button",onClick:()=>a(e=>!e),className:"absolute top-3 right-3 z-20 bg-white/10 hover:bg-white/20 text-white text-xs px-2 py-1 rounded",children:"Info"}),l&&r?.ownerPublicKey&&(0,i.jsxs)("div",{className:"absolute top-10 right-3 z-20 bg-black/80 border border-neutral-700 rounded p-3 text-xs text-gray-200 max-w-[80%]",children:[i.jsx("div",{className:"font-semibold mb-1",children:"Creator Wallet"}),i.jsx("div",{className:"break-all text-gray-300",children:r.ownerPublicKey})]}),!e&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 z-10",children:(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Approval Required"}),i.jsx("p",{className:"text-gray-400",children:"Approve token streaming to start watching"})]})}),"youtube"===u.kind?i.jsx("iframe",{id:"yt-player",ref:o,className:"w-full h-full",src:`https://www.youtube.com/embed/${u.id}?enablejsapi=1&controls=1&rel=0&modestbranding=1&autoplay=${e?1:0}`,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):"twitch"===u.kind?i.jsx("iframe",{className:"w-full h-full",src:`https://player.twitch.tv/?channel=${u.channel}&parent=${window.location.hostname}&autoplay=${e?"true":"false"}`,title:"Twitch stream player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):(0,i.jsxs)("video",{ref:n,className:"w-full h-full",controls:e,loop:!0,muted:!0,playsInline:!0,poster:u.poster||"",children:[i.jsx("source",{src:u.url,type:"video/mp4"}),"Your browser does not support the video tag."]})]})}var l=r(4185),a=r(3353),c=r.n(a),u=r(9958),d=r(7543),f=r(7553);let h=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)}),p=e=>t=>{let r=(0,d.Ik)(e,t),{encode:n,decode:i}=h(r);return r.decode=(e,t)=>{let r=i(e,t);return(0,f.oU)(Buffer.from(r))},r.encode=(t,r,i)=>n((0,f.k$)(t,e),r,i),r},m=e=>t=>{let r=(0,d.Ik)(e,t),{encode:n,decode:i}=h(r);return r.decode=(e,t)=>{let r=i(e,t);return(0,f.Q5)(Buffer.from(r))},r.encode=(t,r,i)=>n((0,f.zP)(t,e),r,i),r},g=p(8);m(8),p(16),m(16),p(24),m(24),p(32),m(32);var x=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,b=Math.ceil,v=Math.floor,y="[BigNumber Error] ",w=y+"Number primitive has more than 15 significant digits: ",N=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function j(e){var t=0|e;return e>0||e===t?t:t-1}function E(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function P(e,t){var r,n,i=e.c,s=t.c,o=e.s,l=t.s,a=e.e,c=t.e;if(!o||!l)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-l:o;if(o!=l)return o;if(r=o<0,n=a==c,!i||!s)return n?0:!i^r?1:-1;if(!n)return a>c^r?1:-1;for(o=0,l=(a=i.length)<(c=s.length)?a:c;o<l;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return a==c?0:a>c^r?1:-1}function S(e,t,r,n){if(e<t||e>r||e!==v(e))throw Error(y+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function A(e){var t=e.c.length-1;return j(e.e/14)==t&&e.c[t]%2!=0}function k(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function _(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(n=e.length,++t>n){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}new(function e(t){var r,n,i,s,o,l,a,c,u,d=D.prototype={constructor:D,toString:null,valueOf:null},f=new D(1),h=20,p=4,m=-7,g=21,T=-1e7,O=1e7,C=!1,I=1,B=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},M="0123456789abcdefghijklmnopqrstuvwxyz",z=!0;function D(e,t){var r,n,i,s,o,l,a,d,f=this;if(!(f instanceof D))return new D(e,t);if(null==t){if(e&&!0===e._isBigNumber){f.s=e.s,!e.c||e.e>O?f.c=f.e=null:e.e<T?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice());return}if((l="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(s=0,o=e;o>=10;o/=10,s++);s>O?f.c=f.e=null:(f.e=s,f.c=[e]);return}d=String(e)}else{if(!x.test(d=String(e)))return u(f,d,l);f.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(s=d.indexOf("."))>-1&&(d=d.replace(".","")),(o=d.search(/e/i))>0?(s<0&&(s=o),s+=+d.slice(o+1),d=d.substring(0,o)):s<0&&(s=d.length)}else{if(S(t,2,M.length,"Base"),10==t&&z)return F(f=new D(e),h+f.e+1,p);if(d=String(e),l="number"==typeof e){if(0*e!=0)return u(f,d,l,t);if(f.s=1/e<0?(d=d.slice(1),-1):1,D.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(w+e)}else f.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(r=M.slice(0,t),s=o=0,a=d.length;o<a;o++)if(0>r.indexOf(n=d.charAt(o))){if("."==n){if(o>s){s=a;continue}}else if(!i&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){i=!0,o=-1,s=0;continue}return u(f,String(e),l,t)}l=!1,(s=(d=c(d,t,10,f.s)).indexOf("."))>-1?d=d.replace(".",""):s=d.length}for(o=0;48===d.charCodeAt(o);o++);for(a=d.length;48===d.charCodeAt(--a););if(d=d.slice(o,++a)){if(a-=o,l&&D.DEBUG&&a>15&&(e>9007199254740991||e!==v(e)))throw Error(w+f.s*e);if((s=s-o-1)>O)f.c=f.e=null;else if(s<T)f.c=[f.e=0];else{if(f.e=s,f.c=[],o=(s+1)%14,s<0&&(o+=14),o<a){for(o&&f.c.push(+d.slice(0,o)),a-=14;o<a;)f.c.push(+d.slice(o,o+=14));o=14-(d=d.slice(o)).length}else o-=a;for(;o--;d+="0");f.c.push(+d)}}else f.c=[f.e=0]}function R(e,t,r,n){var i,s,o,l,a;if(null==r?r=p:S(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)a=E(e.c),a=1==n||2==n&&(o<=m||o>=g)?k(a,o):_(a,o,"0");else if(s=(e=F(new D(e),t,r)).e,l=(a=E(e.c)).length,1==n||2==n&&(t<=s||s<=m)){for(;l<t;a+="0",l++);a=k(a,s)}else if(t-=o+(2===n&&s>o),a=_(a,s,"0"),s+1>l){if(--t>0)for(a+=".";t--;a+="0");}else if((t+=s-l)>0)for(s+1==l&&(a+=".");t--;a+="0");return e.s<0&&i?"-"+a:a}function L(e,t){for(var r,n,i=1,s=new D(e[0]);i<e.length;i++)(n=new D(e[i])).s&&(r=P(s,n))!==t&&(0!==r||s.s!==t)||(s=n);return s}function q(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+14*r-1)>O?e.c=e.e=null:r<T?e.c=[e.e=0]:(e.e=r,e.c=t),e}function F(e,t,r,n){var i,s,o,l,a,c,u,d=e.c;if(d){e:{for(i=1,l=d[0];l>=10;l/=10,i++);if((s=t-i)<0)s+=14,o=t,u=v((a=d[c=0])/N[i-o-1]%10);else if((c=b((s+1)/14))>=d.length){if(n){for(;d.length<=c;d.push(0));a=u=0,i=1,s%=14,o=s-14+1}else break e}else{for(i=1,a=l=d[c];l>=10;l/=10,i++);s%=14,u=(o=s-14+i)<0?0:v(a/N[i-o-1]%10)}if(n=n||t<0||null!=d[c+1]||(o<0?a:a%N[i-o-1]),n=r<4?(u||n)&&(0==r||r==(e.s<0?3:2)):u>5||5==u&&(4==r||n||6==r&&(s>0?o>0?a/N[i-o]:0:d[c-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,n?(t-=e.e+1,d[0]=N[(14-t%14)%14],e.e=-t||0):d[0]=e.e=0,e;if(0==s?(d.length=c,l=1,c--):(d.length=c+1,l=N[14-s],d[c]=o>0?v(a/N[i-o]%N[o])*l:0),n)for(;;){if(0==c){for(s=1,o=d[0];o>=10;o/=10,s++);for(o=d[0]+=l,l=1;o>=10;o/=10,l++);s!=l&&(e.e++,1e14==d[0]&&(d[0]=1));break}if(d[c]+=l,1e14!=d[c])break;d[c--]=0,l=1}for(s=d.length;0===d[--s];d.pop());}e.e>O?e.c=e.e=null:e.e<T&&(e.c=[e.e=0])}return e}function G(e){var t,r=e.e;return null===r?e.toString():(t=E(e.c),t=r<=m||r>=g?k(t,r):_(t,r,"0"),e.s<0?"-"+t:t)}return D.clone=e,D.ROUND_UP=0,D.ROUND_DOWN=1,D.ROUND_CEIL=2,D.ROUND_FLOOR=3,D.ROUND_HALF_UP=4,D.ROUND_HALF_DOWN=5,D.ROUND_HALF_EVEN=6,D.ROUND_HALF_CEIL=7,D.ROUND_HALF_FLOOR=8,D.EUCLID=9,D.config=D.set=function(e){var t,r;if(null!=e){if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(S(r=e[t],0,1e9,t),h=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(S(r=e[t],0,8,t),p=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(S(r[0],-1e9,0,t),S(r[1],0,1e9,t),m=r[0],g=r[1]):(S(r,-1e9,1e9,t),m=-(g=r<0?-r:r))),e.hasOwnProperty(t="RANGE")){if((r=e[t])&&r.pop)S(r[0],-1e9,-1,t),S(r[1],1,1e9,t),T=r[0],O=r[1];else if(S(r,-1e9,1e9,t),r)T=-(O=r<0?-r:r);else throw Error(y+t+" cannot be zero: "+r)}if(e.hasOwnProperty(t="CRYPTO")){if(!!(r=e[t])===r){if(r){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))C=r;else throw C=!r,Error(y+"crypto unavailable")}else C=r}else throw Error(y+t+" not true or false: "+r)}if(e.hasOwnProperty(t="MODULO_MODE")&&(S(r=e[t],0,9,t),I=r),e.hasOwnProperty(t="POW_PRECISION")&&(S(r=e[t],0,1e9,t),B=r),e.hasOwnProperty(t="FORMAT")){if("object"==typeof(r=e[t]))U=r;else throw Error(y+t+" not an object: "+r)}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(y+t+" invalid: "+r);z="0123456789"==r.slice(0,10),M=r}}else throw Error(y+"Object expected: "+e)}return{DECIMAL_PLACES:h,ROUNDING_MODE:p,EXPONENTIAL_AT:[m,g],RANGE:[T,O],CRYPTO:C,MODULO_MODE:I,POW_PRECISION:B,FORMAT:U,ALPHABET:M}},D.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!D.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"==({}).toString.call(n)){if((1===s||-1===s)&&i>=-1e9&&i<=1e9&&i===v(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=1e14||r!==v(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(y+"Invalid BigNumber: "+e)},D.maximum=D.max=function(){return L(arguments,-1)},D.minimum=D.min=function(){return L(arguments,1)},D.random=(r=9007199254740992*Math.random()&2097151?function(){return v(9007199254740992*Math.random())}:function(){return(1073741824*Math.random()|0)*8388608+(8388608*Math.random()|0)},function(e){var t,n,i,s,o,l=0,a=[],c=new D(f);if(null==e?e=h:S(e,0,1e9),s=b(e/14),C){if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));l<s;)(o=131072*t[l]+(t[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[l]=n[0],t[l+1]=n[1]):(a.push(o%1e14),l+=2);l=s/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(s*=7);l<s;)(o=(31&t[l])*281474976710656+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(a.push(o%1e14),l+=7);l=s/7}else throw C=!1,Error(y+"crypto unavailable")}if(!C)for(;l<s;)(o=r())<9e15&&(a[l++]=o%1e14);for(s=a[--l],e%=14,s&&e&&(o=N[14-e],a[l]=v(s/o)*o);0===a[l];a.pop(),l--);if(l<0)a=[i=0];else{for(i=-1;0===a[0];a.splice(0,1),i-=14);for(l=1,o=a[0];o>=10;o/=10,l++);l<14&&(i-=14-l)}return c.e=i,c.c=a,c}),D.sum=function(){for(var e=1,t=arguments,r=new D(t[0]);e<t.length;)r=r.plus(t[e++]);return r},c=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],l=0,a=e.length;l<a;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(l++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(r,n,i,s,o){var l,c,u,d,f,m,g,x,b=r.indexOf("."),v=h,y=p;for(b>=0&&(d=B,B=0,r=r.replace(".",""),m=(x=new D(n)).pow(r.length-b),B=d,x.c=t(_(E(m.c),m.e,"0"),10,i,e),x.e=x.c.length),u=d=(g=t(r,n,i,o?(l=M,e):(l=e,M))).length;0==g[--d];g.pop());if(!g[0])return l.charAt(0);if(b<0?--u:(m.c=g,m.e=u,m.s=s,g=(m=a(m,x,v,y,i)).c,f=m.r,u=m.e),b=g[c=u+v+1],d=i/2,f=f||c<0||null!=g[c+1],f=y<4?(null!=b||f)&&(0==y||y==(m.s<0?3:2)):b>d||b==d&&(4==y||f||6==y&&1&g[c-1]||y==(m.s<0?8:7)),c<1||!g[0])r=f?_(l.charAt(1),-v,l.charAt(0)):l.charAt(0);else{if(g.length=c,f)for(--i;++g[--c]>i;)g[c]=0,c||(++u,g=[1].concat(g));for(d=g.length;!g[--d];);for(b=0,r="";b<=d;r+=l.charAt(g[b++]));r=_(r,u,l.charAt(0))}return r}}(),a=function(){function e(e,t,r){var n,i,s,o,l=0,a=e.length,c=t%1e7,u=t/1e7|0;for(e=e.slice();a--;)n=u*(s=e[a]%1e7)+(o=e[a]/1e7|0)*c,l=((i=c*s+n%1e7*1e7+l)/r|0)+(n/1e7|0)+u*o,e[a]=i%r;return l&&(e=[l].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,o,l){var a,c,u,d,f,h,p,m,g,x,b,y,w,N,E,P,S,A=n.s==i.s?1:-1,k=n.c,_=i.c;if(!k||!k[0]||!_||!_[0])return new D(n.s&&i.s&&(k?!_||k[0]!=_[0]:_)?k&&0==k[0]||!_?0*A:A/0:NaN);for(g=(m=new D(A)).c=[],A=s+(c=n.e-i.e)+1,l||(l=1e14,c=j(n.e/14)-j(i.e/14),A=A/14|0),u=0;_[u]==(k[u]||0);u++);if(_[u]>(k[u]||0)&&c--,A<0)g.push(1),d=!0;else{for(N=k.length,P=_.length,u=0,A+=2,(f=v(l/(_[0]+1)))>1&&(_=e(_,f,l),k=e(k,f,l),P=_.length,N=k.length),w=P,b=(x=k.slice(0,P)).length;b<P;x[b++]=0);S=[0].concat(S=_.slice()),E=_[0],_[1]>=l/2&&E++;do{if(f=0,(a=t(_,x,P,b))<0){if(y=x[0],P!=b&&(y=y*l+(x[1]||0)),(f=v(y/E))>1)for(f>=l&&(f=l-1),p=(h=e(_,f,l)).length,b=x.length;1==t(h,x,p,b);)f--,r(h,P<p?S:_,p,l),p=h.length,a=1;else 0==f&&(a=f=1),p=(h=_.slice()).length;if(p<b&&(h=[0].concat(h)),r(x,h,b,l),b=x.length,-1==a)for(;1>t(_,x,P,b);)f++,r(x,P<b?S:_,b,l),b=x.length}else 0===a&&(f++,x=[0]);g[u++]=f,x[0]?x[b++]=k[w]||0:(x=[k[w]],b=1)}while((w++<N||null!=x[0])&&A--);d=null!=x[0],g[0]||g.splice(0,1)}if(1e14==l){for(u=1,A=g[0];A>=10;A/=10,u++);F(m,s+(m.e=u+14*c-1)+1,o,d)}else m.e=c,m.r=+d;return m}}(),n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,i=/^([^.]+)\.$/,s=/^\.([^.]+)$/,o=/^-?(Infinity|NaN)$/,l=/^\s*\+(?=[\w.])|^\s+|\s+$/g,u=function(e,t,r,a){var c,u=r?t:t.replace(l,"");if(o.test(u))e.s=isNaN(u)?null:u<0?-1:1;else{if(!r&&(u=u.replace(n,function(e,t,r){return c="x"==(r=r.toLowerCase())?16:"b"==r?2:8,a&&a!=c?e:t}),a&&(c=a,u=u.replace(i,"$1").replace(s,"0.$1")),t!=u))return new D(u,c);if(D.DEBUG)throw Error(y+"Not a"+(a?" base "+a:"")+" number: "+t);e.s=null}e.c=e.e=null},d.absoluteValue=d.abs=function(){var e=new D(this);return e.s<0&&(e.s=1),e},d.comparedTo=function(e,t){return P(this,new D(e,t))},d.decimalPlaces=d.dp=function(e,t){var r,n,i;if(null!=e)return S(e,0,1e9),null==t?t=p:S(t,0,8),F(new D(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-j(this.e/14))*14,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},d.dividedBy=d.div=function(e,t){return a(this,new D(e,t),h,p)},d.dividedToIntegerBy=d.idiv=function(e,t){return a(this,new D(e,t),0,1)},d.exponentiatedBy=d.pow=function(e,t){var r,n,i,s,o,l,a,c,u,d=this;if((e=new D(e)).c&&!e.isInteger())throw Error(y+"Exponent not an integer: "+G(e));if(null!=t&&(t=new D(t)),l=e.e>14,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!e.c||!e.c[0])return u=new D(Math.pow(+G(d),l?e.s*(2-A(e)):+G(e))),t?u.mod(t):u;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new D(NaN);(n=!a&&d.isInteger()&&t.isInteger())&&(d=d.mod(t))}else{if(e.e>9&&(d.e>0||d.e<-1||(0==d.e?d.c[0]>1||l&&d.c[1]>=24e7:d.c[0]<8e13||l&&d.c[0]<=9999975e7)))return s=d.s<0&&A(e)?-0:0,d.e>-1&&(s=1/s),new D(a?1/s:s);B&&(s=b(B/14+2))}for(l?(r=new D(.5),a&&(e.s=1),c=A(e)):c=(i=Math.abs(+G(e)))%2,u=new D(f);;){if(c){if(!(u=u.times(d)).c)break;s?u.c.length>s&&(u.c.length=s):n&&(u=u.mod(t))}if(i){if(0===(i=v(i/2)))break;c=i%2}else if(F(e=e.times(r),e.e+1,1),e.e>14)c=A(e);else{if(0==(i=+G(e)))break;c=i%2}d=d.times(d),s?d.c&&d.c.length>s&&(d.c.length=s):n&&(d=d.mod(t))}return n?u:(a&&(u=f.div(u)),t?u.mod(t):s?F(u,B,p,o):u)},d.integerValue=function(e){var t=new D(this);return null==e?e=p:S(e,0,8),F(t,t.e+1,e)},d.isEqualTo=d.eq=function(e,t){return 0===P(this,new D(e,t))},d.isFinite=function(){return!!this.c},d.isGreaterThan=d.gt=function(e,t){return P(this,new D(e,t))>0},d.isGreaterThanOrEqualTo=d.gte=function(e,t){return 1===(t=P(this,new D(e,t)))||0===t},d.isInteger=function(){return!!this.c&&j(this.e/14)>this.c.length-2},d.isLessThan=d.lt=function(e,t){return 0>P(this,new D(e,t))},d.isLessThanOrEqualTo=d.lte=function(e,t){return -1===(t=P(this,new D(e,t)))||0===t},d.isNaN=function(){return!this.s},d.isNegative=function(){return this.s<0},d.isPositive=function(){return this.s>0},d.isZero=function(){return!!this.c&&0==this.c[0]},d.minus=function(e,t){var r,n,i,s,o=this.s;if(t=(e=new D(e,t)).s,!o||!t)return new D(NaN);if(o!=t)return e.s=-t,this.plus(e);var l=this.e/14,a=e.e/14,c=this.c,u=e.c;if(!l||!a){if(!c||!u)return c?(e.s=-t,e):new D(u?this:NaN);if(!c[0]||!u[0])return u[0]?(e.s=-t,e):new D(c[0]?this:3==p?-0:0)}if(l=j(l),a=j(a),c=c.slice(),o=l-a){for((s=o<0)?(o=-o,i=c):(a=l,i=u),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(n=(s=(o=c.length)<(t=u.length))?o:t,o=t=0;t<n;t++)if(c[t]!=u[t]){s=c[t]<u[t];break}if(s&&(i=c,c=u,u=i,e.s=-e.s),(t=(n=u.length)-(r=c.length))>0)for(;t--;c[r++]=0);for(t=1e14-1;n>o;){if(c[--n]<u[n]){for(r=n;r&&!c[--r];c[r]=t);--c[r],c[n]+=1e14}c[n]-=u[n]}for(;0==c[0];c.splice(0,1),--a);return c[0]?q(e,c,a):(e.s=3==p?-1:1,e.c=[e.e=0],e)},d.modulo=d.mod=function(e,t){var r,n;return(e=new D(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==I?(n=e.s,e.s=1,r=a(this,e,0,3),e.s=n,r.s*=n):r=a(this,e,0,I),(e=this.minus(r.times(e))).c[0]||1!=I||(e.s=this.s),e):new D(this):new D(NaN)},d.multipliedBy=d.times=function(e,t){var r,n,i,s,o,l,a,c,u,d,f,h,p,m=this.c,g=(e=new D(e,t)).c;if(!m||!g||!m[0]||!g[0])return this.s&&e.s&&(!m||m[0]||g)&&(!g||g[0]||m)?(e.s*=this.s,m&&g?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(n=j(this.e/14)+j(e.e/14),e.s*=this.s,(a=m.length)<(d=g.length)&&(p=m,m=g,g=p,i=a,a=d,d=i),i=a+d,p=[];i--;p.push(0));for(i=d;--i>=0;){for(r=0,f=g[i]%1e7,h=g[i]/1e7|0,s=i+(o=a);s>i;)l=h*(c=m[--o]%1e7)+(u=m[o]/1e7|0)*f,r=((c=f*c+l%1e7*1e7+p[s]+r)/1e14|0)+(l/1e7|0)+h*u,p[s--]=c%1e14;p[s]=r}return r?++n:p.splice(0,1),q(e,p,n)},d.negated=function(){var e=new D(this);return e.s=-e.s||null,e},d.plus=function(e,t){var r,n=this.s;if(t=(e=new D(e,t)).s,!n||!t)return new D(NaN);if(n!=t)return e.s=-t,this.minus(e);var i=this.e/14,s=e.e/14,o=this.c,l=e.c;if(!i||!s){if(!o||!l)return new D(n/0);if(!o[0]||!l[0])return l[0]?e:new D(o[0]?this:0*n)}if(i=j(i),s=j(s),o=o.slice(),n=i-s){for(n>0?(s=i,r=l):(n=-n,r=o),r.reverse();n--;r.push(0));r.reverse()}for((n=o.length)-(t=l.length)<0&&(r=l,l=o,o=r,t=n),n=0;t;)n=(o[--t]=o[t]+l[t]+n)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return n&&(o=[n].concat(o),++s),q(e,o,s)},d.precision=d.sd=function(e,t){var r,n,i;if(null!=e&&!!e!==e)return S(e,1,1e9),null==t?t=p:S(t,0,8),F(new D(this),e,t);if(!(r=this.c))return null;if(n=14*(i=r.length-1)+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},d.shiftedBy=function(e){return S(e,-9007199254740991,9007199254740991),this.times("1e"+e)},d.squareRoot=d.sqrt=function(){var e,t,r,n,i,s=this.c,o=this.s,l=this.e,c=h+4,u=new D("0.5");if(1!==o||!s||!s[0])return new D(!o||o<0&&(!s||s[0])?NaN:s?this:1/0);if(0==(o=Math.sqrt(+G(this)))||o==1/0?(((t=E(s)).length+l)%2==0&&(t+="0"),o=Math.sqrt(+t),l=j((l+1)/2)-(l<0||l%2),r=new D(t=o==1/0?"5e"+l:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new D(o+""),r.c[0]){for((o=(l=r.e)+c)<3&&(o=0);;)if(i=r,r=u.times(i.plus(a(this,i,c,1))),E(i.c).slice(0,o)===(t=E(r.c)).slice(0,o)){if(r.e<l&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(F(r,r.e+h+2,1),e=!r.times(r).eq(this));break}if(!n&&(F(i,i.e+h+2,0),i.times(i).eq(this))){r=i;break}c+=4,o+=4,n=1}}return F(r,r.e+h+1,p,e)},d.toExponential=function(e,t){return null!=e&&(S(e,0,1e9),e++),R(this,e,t,1)},d.toFixed=function(e,t){return null!=e&&(S(e,0,1e9),e=e+this.e+1),R(this,e,t)},d.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=U;else if("object"!=typeof r)throw Error(y+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,s=n.split("."),o=+r.groupSize,l=+r.secondaryGroupSize,a=r.groupSeparator||"",c=s[0],u=s[1],d=this.s<0,f=d?c.slice(1):c,h=f.length;if(l&&(i=o,o=l,l=i,h-=i),o>0&&h>0){for(i=h%o||o,c=f.substr(0,i);i<h;i+=o)c+=a+f.substr(i,o);l>0&&(c+=a+f.slice(i)),d&&(c="-"+c)}n=u?c+(r.decimalSeparator||"")+((l=+r.fractionGroupSize)?u.replace(RegExp("\\d{"+l+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):u):c}return(r.prefix||"")+n+(r.suffix||"")},d.toFraction=function(e){var t,r,n,i,s,o,l,c,u,d,h,m,g=this.c;if(null!=e&&(!(l=new D(e)).isInteger()&&(l.c||1!==l.s)||l.lt(f)))throw Error(y+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+G(l));if(!g)return new D(this);for(t=new D(f),u=r=new D(f),n=c=new D(f),m=E(g),s=t.e=m.length-this.e-1,t.c[0]=N[(o=s%14)<0?14+o:o],e=!e||l.comparedTo(t)>0?s>0?t:u:l,o=O,O=1/0,l=new D(m),c.c[0]=0;d=a(l,t,0,1),1!=(i=r.plus(d.times(n))).comparedTo(e);)r=n,n=i,u=c.plus(d.times(i=u)),c=i,t=l.minus(d.times(i=t)),l=i;return i=a(e.minus(r),n,0,1),c=c.plus(i.times(u)),r=r.plus(i.times(n)),c.s=u.s=this.s,s*=2,h=1>a(u,n,s,p).minus(this).abs().comparedTo(a(c,r,s,p).minus(this).abs())?[u,n]:[c,r],O=o,h},d.toNumber=function(){return+G(this)},d.toPrecision=function(e,t){return null!=e&&S(e,1,1e9),R(this,e,t,2)},d.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=m||i>=g?k(E(r.c),i):_(E(r.c),i,"0"):10===e&&z?t=_(E((r=F(new D(r),h+i+1,p)).c),r.e,"0"):(S(e,2,M.length,"Base"),t=c(_(E(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},d.valueOf=d.toJSON=function(){return G(this)},d._isBigNumber=!0,d[Symbol.toStringTag]="BigNumber",d[Symbol.for("nodejs.util.inspect.custom")]=d.valueOf,null!=t&&D.set(t),D}())("1e+18");let T=e=>{let t=(0,d.Ik)(32,e),{encode:r,decode:n}=h(t);return t.decode=(e,t)=>{let r=n(e,t);return new u.PublicKey(r)},t.encode=(e,t,n)=>r(e.toBuffer(),t,n),t},O=new u.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");new u.PublicKey("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb");let C=new u.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new u.PublicKey("So11111111111111111111111111111111111111112"),new u.PublicKey("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");class I extends Error{constructor(e){super(e)}}class B extends I{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}async function U(e,t,r=!1,n=O,i=C){if(!r&&!u.PublicKey.isOnCurve(t.toBuffer()))throw new B;let[s]=await u.PublicKey.findProgramAddress([t.toBuffer(),n.toBuffer(),e.toBuffer()],i);return s}(0,d.n_)([(0,d.Jq)("mintAuthorityOption"),T("mintAuthority"),g("supply"),(0,d.u8)("decimals"),(e=>{let t=(0,d.u8)(e),{encode:r,decode:n}=h(t);return t.decode=(e,t)=>!!n(e,t),t.encode=(e,t,n)=>r(Number(e),t,n),t})("isInitialized"),(0,d.Jq)("freezeAuthorityOption"),T("freezeAuthority")]).span,!function(e){e[e.InitializeMint=0]="InitializeMint",e[e.InitializeAccount=1]="InitializeAccount",e[e.InitializeMultisig=2]="InitializeMultisig",e[e.Transfer=3]="Transfer",e[e.Approve=4]="Approve",e[e.Revoke=5]="Revoke",e[e.SetAuthority=6]="SetAuthority",e[e.MintTo=7]="MintTo",e[e.Burn=8]="Burn",e[e.CloseAccount=9]="CloseAccount",e[e.FreezeAccount=10]="FreezeAccount",e[e.ThawAccount=11]="ThawAccount",e[e.TransferChecked=12]="TransferChecked",e[e.ApproveChecked=13]="ApproveChecked",e[e.MintToChecked=14]="MintToChecked",e[e.BurnChecked=15]="BurnChecked",e[e.InitializeAccount2=16]="InitializeAccount2",e[e.SyncNative=17]="SyncNative",e[e.InitializeAccount3=18]="InitializeAccount3",e[e.InitializeMultisig2=19]="InitializeMultisig2",e[e.InitializeMint2=20]="InitializeMint2",e[e.GetAccountDataSize=21]="GetAccountDataSize",e[e.InitializeImmutableOwner=22]="InitializeImmutableOwner",e[e.AmountToUiAmount=23]="AmountToUiAmount",e[e.UiAmountToAmount=24]="UiAmountToAmount",e[e.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",e[e.TransferFeeExtension=26]="TransferFeeExtension",e[e.ConfidentialTransferExtension=27]="ConfidentialTransferExtension",e[e.DefaultAccountStateExtension=28]="DefaultAccountStateExtension",e[e.Reallocate=29]="Reallocate",e[e.MemoTransferExtension=30]="MemoTransferExtension",e[e.CreateNativeMint=31]="CreateNativeMint",e[e.InitializeNonTransferableMint=32]="InitializeNonTransferableMint",e[e.InterestBearingMintExtension=33]="InterestBearingMintExtension",e[e.CpiGuardExtension=34]="CpiGuardExtension",e[e.InitializePermanentDelegate=35]="InitializePermanentDelegate",e[e.TransferHookExtension=36]="TransferHookExtension",e[e.MetadataPointerExtension=39]="MetadataPointerExtension",e[e.GroupPointerExtension=40]="GroupPointerExtension",e[e.GroupMemberPointerExtension=41]="GroupMemberPointerExtension",e[e.ScaledUiAmountExtension=43]="ScaledUiAmountExtension",e[e.PausableExtension=44]="PausableExtension"}(n||(n={}));let M=(0,d.n_)([(0,d.u8)("instruction"),g("amount"),(0,d.u8)("decimals")]);async function z({userPublicKey:e,sendTransaction:t,gatewayPubkey:r="6agWSyTuiUv1FTYnW9Qb8iHCkn5NSoFkULxKsrZATooT",allowance:i=1,usdcMint:s="DKrZp2YpejxEFzpS9B5cRyr6U28zoNfHWX4pijTcpump"}){if(console.log("DEBUG env check →",r,s),!r||!s)throw Error("Missing env: NEXT_PUBLIC_GATEWAY_PUBKEY / NEXT_PUBLIC_USDC_MINT");let o=new u.Connection("https://api.devnet.solana.com"),l=new u.PublicKey(s),a=new u.PublicKey(r),c=new u.PublicKey(e),d=BigInt(Math.floor(1e6*i)),f=await U(l,c),h=new u.Transaction().add(function(e,t,r,i,s,o,l=[],a=O){let c=function(e,t,r){if(r.length)for(let n of(e.push({pubkey:t,isSigner:!1,isWritable:!1}),r))e.push({pubkey:n instanceof u.PublicKey?n:n.publicKey,isSigner:!0,isWritable:!1});else e.push({pubkey:t,isSigner:!0,isWritable:!1});return e}([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1}],i,l),d=Buffer.alloc(M.span);return M.encode({instruction:n.ApproveChecked,amount:BigInt(s),decimals:6},d),new u.TransactionInstruction({keys:c,programId:a,data:d})}(f,l,a,c,Number(d),0)),p=await t(h,o,{skipPreflight:!1});return await o.confirmTransaction(p,"confirmed"),p}let D=c()(async()=>{},{loadableGenerated:{modules:["app/components/WalletPanel.jsx -> @solana/wallet-adapter-react-ui"]},ssr:!1}),R=process.env.NEXT_PUBLIC_BACKEND_URL||"https://flowserver.onrender.com",L=R.endsWith("/")?R.slice(0,-1):R;function q({onApprovalSuccess:e,onStop:t,uploaderPubkey:r}){let{publicKey:n,connected:o,sendTransaction:a}=(0,l.O)(),[c,u]=(0,s.useState)(!1),[d,f]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),m=(0,s.useMemo)(()=>"6agWSyTuiUv1FTYnW9Qb8iHCkn5NSoFkULxKsrZATooT",[]);async function g(){if(o&&n){u(!0);try{let t=await z({userPublicKey:n,sendTransaction:a,gatewayPubkey:m,allowance:1e6,usdcMint:"DKrZp2YpejxEFzpS9B5cRyr6U28zoNfHWX4pijTcpump"});await fetch(`${L}/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userPubkey:n.toString(),uploaderPubkey:r})}),f(!0),console.log("Approve tx:",t),e&&e()}catch(e){console.error(e),alert("Approval failed: "+e.message)}finally{u(!1)}}}async function x(){await fetch(`${L}/stop`,{method:"POST"}),f(!1),t&&t()}return(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold mb-3",children:"Wallet & Session"}),i.jsx("div",{className:"flex items-center gap-3 mb-4",children:h&&i.jsx(D,{})}),n&&i.jsx("div",{className:"text-xs text-gray-400 mb-4 break-all",children:n.toString()}),(0,i.jsxs)("div",{className:"text-sm text-gray-300 mb-4",children:["Rate: ",i.jsx("b",{children:"1 Flow / second"}),i.jsx("b",{})]}),(0,i.jsxs)("div",{className:"flex gap-3",children:[i.jsx("button",{className:"button-primary disabled:opacity-50",disabled:!o||d||c,onClick:g,children:c?"Approving…":d?"Streaming Active":"Approve & Start"}),i.jsx("button",{className:"button-secondary disabled:opacity-50",disabled:!d,onClick:x,children:"Stop Streaming"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-3",children:d?"Streaming payments active — 1 token per second.":"Grant permission to start streaming token payments."})]})}function F({transactions:e=[]}){let t=Array.isArray(e)?e:[];return(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Transaction Log"}),i.jsx("div",{className:"space-y-2 text-sm font-mono",children:0===t.length?i.jsx("p",{className:"text-gray-500",children:"No transactions yet"}):t.map((e,t)=>i.jsx("div",{className:"text-gray-300",children:e.txId?(0,i.jsxs)(i.Fragment,{children:[e.text.split("→")[0],"→"," ",i.jsx("a",{href:`https://solscan.io/tx/${e.txId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline underline-offset-2",children:e.text.split("→")[1].trim()})]}):e.text||e},t))})]})}let G=process.env.NEXT_PUBLIC_BACKEND_URL||"https://flowserver.onrender.com",W=G.endsWith("/")?G.slice(0,-1):G;function $(){let[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)([]),[l,a]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[d,f]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[m,g]=(0,s.useState)("all"),x=async()=>{console.log("✅ Approval successful, waiting for first transfer..."),n([]);let e=async()=>{try{let e=await fetch("https://flowserver.onrender.com/status");if((await e.json()).firstTransferConfirmed){console.log("\uD83C\uDFAC First transfer confirmed — starting video"),t(!0);return}}catch(e){console.error("Error checking status:",e)}setTimeout(e,1e3)};e()};return i.jsx("main",{className:"min-h-screen text-white bg-gradient-to-b from-black via-[#0a0a0a] to-black",children:(0,i.jsxs)("div",{className:"px-6 py-16 mx-auto space-y-10 max-w-7xl",children:[(0,i.jsxs)("header",{children:[i.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"WEB5DTV. Demo"}),i.jsx("p",{className:"text-gray-400",children:"Select a stream below to start a pay-per-second session."})]}),l||c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"grid gap-8 lg:grid-cols-3",children:[i.jsx("div",{className:"p-6 lg:col-span-2 glass",children:i.jsx(o,{isPlaying:e,type:l,video:c})}),(0,i.jsxs)("div",{className:"space-y-6",children:[i.jsx("div",{className:"p-6 glass",children:i.jsx(q,{onApprovalSuccess:x,onStop:()=>{console.log("\uD83D\uDED1 Streaming stopped, pausing video..."),t(!1),n([])},uploaderPubkey:c?c.ownerPublicKey:void 0})}),i.jsx("div",{className:"p-6 glass",children:i.jsx(F,{transactions:r})})]})]}),i.jsx("button",{onClick:()=>{a(null),u(null),t(!1)},className:"mt-10 text-gray-400 underline hover:text-white underline-offset-2",children:"← Back to stream selection"})]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("h2",{className:"text-lg font-semibold",children:"Built-in demo items"})}),i.jsx("div",{className:"grid grid-cols-1 gap-8 mb-10 sm:grid-cols-2 md:grid-cols-3",children:[{id:"youtube",title:"YouTube Stream",description:"Play a live or demo YouTube video.",thumbnail:"https://img.youtube.com/vi/1jzROE6EhxM/hqdefault.jpg"},{id:"movie",title:"Wolf of Wall Street",description:"Stream a movie.",thumbnail:"https://github.com/JamieMay2020/flow402/blob/main/wolft.jpg?raw=true"}].map(e=>(0,i.jsxs)("div",{onClick:()=>{a(e.id),u(null)},className:"cursor-pointer glass rounded-xl overflow-hidden hover:scale-[1.02] transition-transform duration-300 group",children:[i.jsx("div",{className:"relative w-full aspect-[16/9] overflow-hidden",children:i.jsx("img",{src:e.thumbnail,alt:e.title,className:"object-cover w-full h-full transition-transform duration-500 group-hover:scale-105"})}),(0,i.jsxs)("div",{className:"p-5 text-left",children:[i.jsx("h3",{className:"mb-1 text-xl font-semibold",children:e.title}),i.jsx("p",{className:"text-sm text-gray-400",children:e.description})]})]},e.id))}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Approved videos"}),i.jsx("button",{className:"text-sm text-gray-400 hover:text-white",onClick:async()=>{p(!0);try{let e=await fetch(`${W}/videos`),t=await e.json();f(Array.isArray(t)?t:[])}catch(e){console.error(e)}finally{p(!1)}},children:"Refresh"})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>g("all"),className:`px-4 py-2 rounded text-sm transition ${"all"===m?"bg-white text-black font-semibold":"bg-neutral-800 text-gray-300 hover:bg-neutral-700"}`,children:"All"}),i.jsx("button",{onClick:()=>g("video"),className:`px-4 py-2 rounded text-sm transition ${"video"===m?"bg-white text-black font-semibold":"bg-neutral-800 text-gray-300 hover:bg-neutral-700"}`,children:"Videos"}),i.jsx("button",{onClick:()=>g("live"),className:`px-4 py-2 rounded text-sm transition ${"live"===m?"bg-white text-black font-semibold":"bg-neutral-800 text-gray-300 hover:bg-neutral-700"}`,children:"Livestreams"}),i.jsx("button",{onClick:()=>g("movie"),className:`px-4 py-2 rounded text-sm transition ${"movie"===m?"bg-white text-black font-semibold":"bg-neutral-800 text-gray-300 hover:bg-neutral-700"}`,children:"Movies"})]})]}),h?i.jsx("div",{className:"p-5 text-gray-400 glass rounded-xl",children:"Loading approved videos…"}):0===d.length?i.jsx("div",{className:"p-5 text-gray-400 glass rounded-xl",children:"No approved videos yet."}):i.jsx("div",{className:"grid grid-cols-1 gap-8 sm:grid-cols-2 md:grid-cols-3",children:d.filter(e=>"all"===m||e.contentType===m).map(e=>(0,i.jsxs)("div",{onClick:()=>{u(e),a(null)},className:"cursor-pointer glass rounded-xl overflow-hidden hover:scale-[1.02] transition-transform duration-300 group",children:[(0,i.jsxs)("div",{className:"relative w-full aspect-[16/9] overflow-hidden",children:[i.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:"object-cover w-full h-full transition-transform duration-500 group-hover:scale-105"}),"live"===e.contentType&&i.jsx("div",{className:"absolute px-2 py-1 text-xs font-bold text-white bg-red-600 rounded top-2 left-2",children:"LIVE"})]}),(0,i.jsxs)("div",{className:"p-5 text-left",children:[i.jsx("h3",{className:"mb-1 text-xl font-semibold",children:e.title}),e.description&&i.jsx("p",{className:"text-sm text-gray-400 break-all",children:e.description}),(0,i.jsxs)("p",{className:"text-xs text-gray-500",children:[(e.lamportsPerSecond/1e5).toFixed(0)/10," FLOW / second"]})]})]},`video-${e.id}`))})]})]})})}},9643:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var n=r(326),i=r(9495),s=r(7761),o=r(6273),l=r(4932),a=r(888);function c({children:e}){let t=[new l.O,new a.e];return n.jsx(i.U,{endpoint:"https://api.devnet.solana.com",children:n.jsx(s.n,{wallets:t,autoConnect:!0,children:n.jsx(o.s,{children:e})})})}r(6457)},7553:(e,t,r)=>{"use strict";let n;try{n=r(6253)("bigint_buffer")}catch(e){console.warn("bigint: Failed to load bindings, pure JS will be used (try npm run rebuild?)")}t.oU=function(e){if(void 0===n){let t=Buffer.from(e);t.reverse();let r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)}return n.toBigInt(e,!1)},t.Q5=function(e){if(void 0===n){let t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)}return n.toBigInt(e,!0)},t.k$=function(e,t){if(void 0===n){let r=e.toString(16),n=Buffer.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return n.reverse(),n}return n.fromBigInt(e,Buffer.allocUnsafe(t),!1)},t.zP=function(e,t){if(void 0===n){let r=e.toString(16);return Buffer.from(r.padStart(2*t,"0").slice(0,2*t),"hex")}return n.fromBigInt(e,Buffer.allocUnsafe(t),!0)}},6253:(e,t,r)=>{var n=r(7147),i=r(1017),s=r(9003),o=i.join,l=i.dirname,a=n.accessSync&&function(e){try{n.accessSync(e)}catch(e){return!1}return!0}||n.existsSync||i.existsSync,c={arrow:process.env.NODE_BINDINGS_ARROW||" → ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,nodePreGyp:"node-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","addon-build","release","install-root","bindings"],["module_root","addon-build","debug","install-root","bindings"],["module_root","addon-build","default","install-root","bindings"],["module_root","lib","binding","nodePreGyp","bindings"]]};e.exports=t=function(e){"string"==typeof e?e={bindings:e}:e||(e={}),Object.keys(c).map(function(t){t in e||(e[t]=c[t])}),e.module_root||(e.module_root=t.getRoot(t.getFileName())),".node"!=i.extname(e.bindings)&&(e.bindings+=".node");for(var r,n,s,l=require,a=[],u=0,d=e.try.length;u<d;u++){r=o.apply(null,e.try[u].map(function(t){return e[t]||t})),a.push(r);try{return n=e.path?l.resolve(r):l(r),e.path||(n.path=r),n}catch(e){if("MODULE_NOT_FOUND"!==e.code&&"QUALIFIED_PATH_RESOLUTION_FAILED"!==e.code&&!/not find/i.test(e.message))throw e}}throw(s=Error("Could not locate the bindings file. Tried:\n"+a.map(function(t){return e.arrow+t}).join("\n"))).tries=a,s},t.getFileName=function(e){var t,r=Error.prepareStackTrace,n=Error.stackTraceLimit,i={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(r,n){for(var i=0,s=n.length;i<s;i++)if((t=n[i].getFileName())!==__filename&&(!e||t!==e))return},Error.captureStackTrace(i),i.stack,Error.prepareStackTrace=r,Error.stackTraceLimit=n,0===t.indexOf("file://")&&(t=s(t)),t},t.getRoot=function(e){for(var t,r=l(e);;){if("."===r&&(r=process.cwd()),a(o(r,"package.json"))||a(o(r,"node_modules")))return r;if(t===r)throw Error('Could not find module root given file: "'+e+'". Do you have a `package.json` file? ');t=r,r=o(r,"..")}}},9003:(e,t,r)=>{var n=r(1017).sep||"/";e.exports=function(e){if("string"!=typeof e||e.length<=7||"file://"!=e.substring(0,7))throw TypeError("must pass in a file:// URI to convert to a file path");var t=decodeURI(e.substring(7)),r=t.indexOf("/"),i=t.substring(0,r),s=t.substring(r+1);return"localhost"==i&&(i=""),i&&(i=n+n+i),s=s.replace(/^(.+)\|/,"$1:"),"\\"==n&&(s=s.replace(/\//g,"\\")),/^.+\:/.test(s)||(s=n+s),i+s}},3353:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let n=r(1174);r(326),r(7577);let i=n._(r(7028));function s(e,t){var r;let n={loading:e=>{let{error:t,isLoading:r,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let s={...n,...t};return(0,i.default)({...s,modules:null==(r=s.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return i}});let n=r(4129);function i(e){let{reason:t,children:r}=e;throw new n.BailoutToCSRError(t)}},7028:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(326),i=r(7577),s=r(933),o=r(6618);function l(e){return{default:e&&"default"in e?e.default:e}}let a={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},c=function(e){let t={...a,...e},r=(0,i.lazy)(()=>t.loader().then(l)),c=t.loading;function u(e){let l=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,a=t.ssr?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.PreloadCss,{moduleIds:t.modules}),(0,n.jsx)(r,{...e})]}):(0,n.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(i.Suspense,{fallback:l,children:a})}return u.displayName="LoadableComponent",u}},6618:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return s}});let n=r(326),i=r(5403);function s(e){let{moduleIds:t}=e,r=(0,i.getExpectedRequestStore)("next/dynamic css"),s=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));s.push(...t)}}return 0===s.length?null:(0,n.jsx)(n.Fragment,{children:s.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},1958:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>s,default:()=>l});var n=r(8570);let i=(0,n.createProxy)(String.raw`/Users/thewizardofhahz/flow402/app/demo/page.jsx`),{__esModule:s,$$typeof:o}=i;i.default;let l=(0,n.createProxy)(String.raw`/Users/thewizardofhahz/flow402/app/demo/page.jsx#default`)},2846:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,metadata:()=>c});var n=r(9510);r(7633);var i=r(8570);let s=(0,i.createProxy)(String.raw`/Users/thewizardofhahz/flow402/app/providers.jsx`),{__esModule:o,$$typeof:l}=s;s.default;let a=(0,i.createProxy)(String.raw`/Users/thewizardofhahz/flow402/app/providers.jsx#default`),c={title:"WEB5DTV.",description:"PPS (pay-per-second) streaming via HTTP 402 + Solana devnet.",icons:{icon:"/favicon-32x32.png"}};function u({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:"bg-gradient-to-b from-black via-[#0a0a0a] to-black text-white antialiased",children:(0,n.jsxs)(a,{children:[n.jsx(d,{}),n.jsx("div",{className:"pt-20",children:e})]})})})}function d(){return n.jsx("header",{className:"fixed top-0 left-0 right-0 z-20 border-b bg-black/40 backdrop-blur-md border-neutral-800",children:(0,n.jsxs)("nav",{className:"flex items-center justify-between px-6 py-4 mx-auto max-w-7xl",children:[(0,n.jsxs)("a",{href:"https://x402.hahz.live",className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300 shadow-[0_0_12px_rgba(255,255,255,0.3)]"}),n.jsx("span",{className:"font-semibold tracking-tight",children:"WEB5DTV."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-6 text-sm text-gray-300",children:[n.jsx("a",{href:"/create",className:"transition hover:text-white",children:"Create"}),n.jsx("a",{href:"https://hahz.live",target:"_blank",rel:"noreferrer",className:"transition hover:text-white",children:"Subscribe"}),n.jsx("a",{href:"https://app.luvnft.com",target:"_blank",rel:"noreferrer",className:"flex items-center transition hover:text-white","aria-label":"LUV NFT",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:n.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5    2 6.42 3.42 5 5.5 5c1.54 0 3.04.99 3.57 2.36h1.87   C13.46 5.99 14.96 5 16.5 5    18.58 5 20 6.42 20 8.5   c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]})]})})}},7633:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[200],()=>r(5060));module.exports=n})();